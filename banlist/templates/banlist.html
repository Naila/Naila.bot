{% extends "base.html" %}
{% load static %}

{% block extrastyle %}
  <link href="{% static 'css/banlist.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
  <v-container>
    <v-col cols="12" sm="10" md="8" offset-sm="1" offset-md="2">
      <v-card>
        <v-card-title class="d-flex">
          <v-text-field
              v-model="search"
              append-icon="mdi-magnify"
              label="Search"
              color="#AFFAFF"
          >
          </v-text-field>
          <v-spacer></v-spacer>
          <v-btn color="#AFFAFF" style="color: black;">
            Report a user
          </v-btn>
        </v-card-title>
        <hr style="margin-bottom: 10px;">
        <v-card-text>{{ bans }}</v-card-text>
        {% if not bans %}
          <h1 class="display-3 mb-5 text-center">No bans!</h1>
        {% else %}
          {% for id, ban_list in bans.items %}
            <v-card-text>{{ id }}</v-card-text>
            <v-card-text>{{ ban_list }}</v-card-text>
            <v-col cols="12" sm="6" md="4" lg="3">
              <v-card color="secondary">
                <h3 class="text-center">
                  {{ id }}
                </h3>
                <hr>
                {% if not ban_list|length_is:"1" %}
                  <v-tabs fixed-tabs color="#AFFAFF">
                    {% for ban in ban_list %}
                      <v-tab :key="{{ forloop.counter }}">{{ forloop.counter }}</v-tab>
                      <v-tab-item
                          :key="{{ forloop.counter }}"
                          style="background-color: #424242; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px;"
                      >
                        <v-card-text>
                          <p>Reason:
                            <a href="{{ ban.proof }}" target="_blank" style="text-decoration-line: none;">
                              {{ ban.reason }}
                            </a>
                            {% if ban.nsfw %} (<span style="color: red;">NSFW</span>){% endif %}
                          </p>
                          <p>{{ ban.created }}</p>
                        </v-card-text>
                      </v-tab-item>
                    {% endfor %}
                  </v-tabs>
                {% else %}
                  {% with ban_list.0 as ban %}
                    <v-card-text style="color: white;">
                      <p>Reason:
                        <a href="{{ ban.proof }}" target="_blank" style="text-decoration-line: none;">
                          {{ ban.reason }}
                        </a>
                        {% if ban.nsfw %} (<span style="color: red;">NSFW</span>){% endif %}
                      </p>
                      <p>{{ ban.created }}</p>
                    </v-card-text>
                  {% endwith %}
                {% endif %}
              </v-card>
            </v-col>
          {% endfor %}
        {% endif %}
        <v-card-actions>
          <v-pagination
              v-model="page"
              :length="pages"
              total-visible="7"
              color="#AFFAFF"
          ></v-pagination>
        </v-card-actions>
      </v-card>
    </v-col>
  </v-container>
{% endblock %}

{% block data %}
  search: '',
  pages: {{ paginator.num_pages }},
  page: {{ page_obj.number }}
{% endblock %}

{% block watch %}
  {page: function(val) {window.location = `/banlist/?page=${val}`}}
{% endblock %}